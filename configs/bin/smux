#!/usr/bin/env bash

# select the project you wanna work on to create/attach
# to a tmux session
if [[ $# -eq 1 ]]; then
    selected=$1
else
    selected=$(find ~ ~/workspace/devsecops ~/workspace/k8s ~/exercism/go -maxdepth 1 -mindepth 1 -type d | fzf)
fi

dirname=$(basename "$selected" | tr . _)

# create new tmux session (not nested) only if session
# dosn't exist
tmux has-session -t "$dirname" 2> /dev/null || TMUX='' tmux new-session -d -c "$selected" -s "$dirname"

if [[ -z "$TMUX" ]]; then
    # attach to new session (created in detached mode)
    tmux attach -t "$dirname"
else
    # switch to existing session
    tmux switch-client -t "$dirname"
fi
